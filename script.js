// script.js - COMPLETE WITH ALL POETRY & FUNCTIONALITY

// ============================================
// COMPLETE ENGLISH POETRY CONTENT
// ============================================
const englishPoetry = `<p>I miss you in ways that don't announce themselves ЁЯТн,</p>
<p>in ways that live quietly inside my chest</p>
<p>and show up only when the lights are off ЁЯМЩ</p>
<p>and the world finally stops asking me to be strong.</p>
<p>Every night, I sleep with my pillow</p>
<p>the way someone sleeps with a memory ЁЯЫПя╕ПЁЯдН,</p>
<p>holding it close, pretending it can hear me</p>
<p>when I whisper the things I never said out loud.</p>
<p>I talk to myself in the dark, softly, carefully,</p>
<p>like I'm afraid the night might overhearтАФ</p>
<p>did you eat today ЁЯН╜я╕П, are you okay ЁЯл╢,</p>
<p>how was your day, is my baby fineтАФ</p>
<p>and even without answers, my heart refuses to stop caring ЁЯТЧ.</p>
<p>Some habits don't disappear just because silence arrives.</p>
<p>When I close my eyes, I don't see emptiness ЁЯШМ.</p>
<p>I see you. Every single time.</p>
<p>As if my mind has chosen you as its safest place ЁЯлВ.</p>
<p>And it always takes me back to that same nightтАФ</p>
<p>December 17th, 2025, around 10:30 ЁЯХ░я╕ПтАФ</p>
<p>when after four long years, my hand finally found yours again ЁЯдЭ.</p>
<p>It felt unreal, like time folded in on itself</p>
<p>just to give me that moment тЬи.</p>
<p>I remember thinking how strange it was</p>
<p>that something so small, so simple,</p>
<p>could undo years of distance without saying a single word.</p>
<p>Your hands felt rough, and I noticed it instantly.</p>
<p>I know why they are like that.</p>
<p>You carry responsibility quietly,</p>
<p>you do your housework without complaint,</p>
<p>you give more than you talk about.</p>
<p>Take care, bacha ЁЯе║ЁЯдН.</p>
<p>But listen to me when I say thisтАФ</p>
<p>I would choose those hands every time.</p>
<p>Rough or not, tired or worn,</p>
<p>I would still want them on my cheeks and on my back ЁЯлВ,</p>
<p>because they carry effort, honesty,</p>
<p>and a life you've been building on your own.</p>
<p>Some hands aren't meant to be soft;</p>
<p>they're meant to be real тЬЛЁЯТл.</p>
<p>I will never forget that smile on your face ЁЯШК</p>
<p>when my hands were on your cheeks,</p>
<p>the way you softened as I pampered you,</p>
<p>as if for a moment you allowed yourself to feel safe ЁЯХКя╕П.</p>
<p>That smile didn't belong to fear;</p>
<p>it belonged to familiarity, to comfort,</p>
<p>to something that still knew how to feel warm ЁЯТЮ.</p>
<p>I remember the forehead kiss too ЁЯТЛтАФ</p>
<p>your face caught between guilt and happiness,</p>
<p>like your heart was arguing with itself.</p>
<p>You felt guilty for feeling good,</p>
<p>guilty for wanting something you were scared of.</p>
<p>Don't worry ЁЯдН.</p>
<p>Nothing was wrong.</p>
<p>Some moments are not mistakes; they're reminders.</p>
<p>I love you in a way that never tried to rush you,</p>
<p>never demanded clarity,</p>
<p>never forced the future to arrive early ЁЯМ▒.</p>
<p>I wanted to hug you not just to feel you,</p>
<p>but to protect you from the parts of life</p>
<p>that taught you to be afraid of attachment ЁЯл╢.</p>
<p>I know your past made love feel unsafe,</p>
<p>like something that takes more than it gives.</p>
<p>And I know that's why you walked awayтАФ</p>
<p>not because love was missing,</p>
<p>but because staying felt wrong to you at that moment ЁЯТФтЮбя╕ПЁЯдН.</p>
<p>I understand that you weren't unsure about meтАФ</p>
<p>you were unsure about yourself,</p>
<p>about what you want,</p>
<p>about whether your heart is ready to choose again without fear ЁЯе║.</p>
<p>I know hurting me was the one thing you never wanted to do,</p>
<p>and that distance felt kinder than trying</p>
<p>when everything inside you felt confused.</p>
<p>I understand why silence became necessary,</p>
<p>why blocking was the only way you could protect both of us</p>
<p>from emotions you couldn't resist ЁЯЩГ.</p>
<p>I don't hold that against you.</p>
<p>I carry gratitude insteadтАФ</p>
<p>for the love you gave honestly ЁЯТЧ,</p>
<p>for the truth you spoke gently,</p>
<p>and for choosing kindness even while walking away ЁЯдН.</p>
<p>I am waiting, yesтАФbut not frozen, not stuck in the same place ЁЯХ░я╕П.</p>
<p>I am growing, learning, becoming calmer, becoming better ЁЯМ┐,</p>
<p>with the same sincerity I had the first day we met.</p>
<p>I haven't changed in the ways that matter.</p>
<p>The care is the same.</p>
<p>The respect is the same.</p>
<p>The patience never left.</p>
<p>I am still the same person</p>
<p>who chose you without conditions and stayed without resentment ЁЯдН.</p>
<p>As this new year begins тЬи,</p>
<p>I don't ask for answers or promises.</p>
<p>I only wish that you focus on your studies ЁЯУЪ,</p>
<p>on becoming the CA you're working so hard to be ЁЯМЯ.</p>
<p>Don't get distracted.</p>
<p>Stay patient with yourself ЁЯХКя╕П.</p>
<p>Build your future with belief,</p>
<p>even on the days when it feels heavy.</p>
<p>Trust that what is meant for you will arrive in its own time тП│,</p>
<p>exactly when you're ready to receive it.</p>
<p>And if life ever feels overwhelming,</p>
<p>if doubt ever finds you late at night ЁЯМЩ,</p>
<p>remember this quietlyтАФsomewhere, without pressure,</p>
<p>without expectations, without conditions, I am still here ЁЯдН.</p>
<p>Loving you the same way.</p>
<p>Remembering you the same way.</p>
<p>Holding space for you, just as you are ЁЯлВ.</p>
<p>Happy New Year, 2026 ЁЯОЖтЬи</p>
<p>May this year be gentle with you ЁЯдН,</p>
<p>keep you focused ЁЯОп,</p>
<p>teach you patience ЁЯМ╕,</p>
<p>and help you trust God's plan ЁЯЩПтАФ</p>
<p>even when the path doesn't make sense yet.</p>`;

// ============================================
// COMPLETE GUJARATI POETRY CONTENT
// ============================================
const gujaratiPoetry = `<p>ркХрлЗркЯрк▓рлАркХ ркпрк╛ркжрлЛ ркЕрк╡рк╛ркЬ ркиркерлА ркХрк░ркдрлА,</p>
<p>рккркг ркжрк┐рк▓ркорк╛ркВ рк╕ркдркд рк░рк╣рлЗркдрлА рк╣рлЛркп ркЫрлЗ ЁЯТн.</p>
<p>рк╣рлБркВ ркдркирлЗ ркпрк╛ркж ркХрк░рлБркВ ркЫрлБркВ ркдрлНркпрк╛рк░рлЗ ркХрлЛркИ рклрк░рк┐ркпрк╛ркж ркиркерлА,</p>
<p>рклркХрлНркд ркПркХ рк╢рк╛ркВркд рк▓рк╛ркЧркгрлА ркЫрлЗ</p>
<p>ркЬрлЗ рк░рк╛ркдрлНрк░рлЗ рк╡ркзрлБ ркЬрлАрк╡ркВркд ркмркирлА ркЬрк╛ркп ркЫрлЗ ЁЯМЩ.</p>
<p>ркдркХрлАркпрк╛ркирлЗ ркиркЬрлАркХ ркЦрлЗркВркЪрлА ркирлЗ рк╕рлВркИ ркЬрк╛ркЙркВ ркЫрлБркВ,</p>
<p>ркЬрк╛ркгрлЗ ркПркорк╛ркВ ркдрк╛рк░рлА рк╣рк╛ркЬрк░рлА рк╕ркЪрк╡рк╛ркпрлЗрк▓рлА рк╣рлЛркп ЁЯЫПя╕ПЁЯдН,</p>
<p>ркЕркирлЗ ркоркиркорк╛ркВ ркЬ ркоркиркорк╛ркВ рккрлВркЫрлБркВ ркЫрлБркВтАФ</p>
<p>ркЖркЬрлЗ ркдрлБркВ ркарлАркХ рк╣рк╢рлЗ ркирлЗ ЁЯл╢,</p>
<p>ркнрлЛркЬрки ркХрк░рлНркпрлБркВ рк╣рк╢рлЗ ркирлЗ ЁЯН╜я╕П,</p>
<p>ркдрк╛рк░рлЛ ркжрк┐рк╡рк╕ ркнрк╛рк░рлЗрк▓рлЛ ркдрлЛ ркирк╣рлАркВ ркЧркпрлЛ рк╣рк╢рлЗ,</p>
<p>ркорк╛рк░рлА ркмркЪрлНркЪрлА рк╕рлБрк░ркХрлНрк╖рк┐ркд ркдрлЛ рк╣рк╢рлЗ ркирлЗ ЁЯТЧ.</p>
<p>ркЬрк╡рк╛ркм ркиркерлА ркорк│ркдрк╛,</p>
<p>рккркг рккрлНрк░рк╢рлНркирлЛ рккрлВркЫрк╡рк╛ркорк╛ркВ рккркг ркПркХ рк╕рлБркХрлБркВ рк╕рлБркЦ рк╣рлЛркп ркЫрлЗ.</p>
<p>ркЖркВркЦрлЛ ркмркВркз ркХрк░рлБркВ ркЫрлБркВ ркдрлНркпрк╛рк░рлЗ ркЦрк╛рк▓рлАрккрлЛ ркиркерлА ркЖрк╡ркдрлЛ ЁЯШМ.</p>
<p>ркжрк░ рк╡ркЦркдрлЗ ркдрлБркВ ркЬ рк╕рк╛ркорлЗ ркЖрк╡рлА ркЬрк╛ркп ркЫрлЗ ЁЯлВ.</p>
<p>ркЕркирлЗ ркорки ркЕркЪрлВркХ ркП ркЬ рк░рк╛ркдрлНрк░рлЗ ркЕркЯркХрлА ркЬрк╛ркп ркЫрлЗтАФ</p>
<p>17 ркбрк┐рк╕рлЗркорлНркмрк░ 2025,</p>
<p>рк░рк╛ркдрлНрк░рлЗ ркЖрк╢рк░рлЗ 10:30 ЁЯХ░я╕П.</p>
<p>ркЪрк╛рк░ рк╡рк░рлНрк╖ рккркЫрлА рклрк░рлА ркдрк╛рк░рлЛ рк╣рк╛рке рккркХркбрлА рк╢ркХрлНркпрлЛ ЁЯдЭ,</p>
<p>ркП ркХрлНрк╖ркгркорк╛ркВ ркХрлЛркИ рк╡ркЪрки ркирк╣рлЛркдрлБркВ,</p>
<p>ркХрлЛркИ ркнрк╡рк┐рк╖рлНркпркирлА рк╡рк╛ркд ркирк╣рлЛркдрлА,</p>
<p>рклркХрлНркд ркПркХ рк╕рк╛ркЪрлЛ рк╕рлНрккрк░рлНрк╢ рк╣ркдрлЛ тЬи</p>
<p>ркЬрлЗ ркмркзрлБркВ ркХрк╣рлА ркЧркпрлЛ.</p>
<p>ркдрк╛рк░рк╛ рк╣рк╛рке ркерлЛркбрк╛ ркЦркбркЦркбрк┐ркпрк╛ рк▓рк╛ркЧрлНркпрк╛,</p>
<p>ркЕркирлЗ ркоркирлЗ ркП ркдрк░ркд рк╕ркоркЬрк╛ркИ ркЧркпрлБркВ.</p>
<p>ркдрлБркВ ркХрлЗркЯрк▓рлБркВ ркмркзрлБркВ ркПркХрк▓рлА рк╕ркВркнрк╛рк│рлЗ ркЫрлЗтАФ</p>
<p>ркШрк░, ркЬрк╡рк╛ркмркжрк╛рк░рлАркУ, рк░рлЛркЬрк┐ркВркжрлА ркерк╛ркХ.</p>
<p>ркзрлНркпрк╛рки рк░рк╛ркЦркЬрлЗ ркмркЪрлНркЪрлА ЁЯе║ЁЯдН.</p>
<p>рккркг рк╕рк╛ркЪрлБркВ ркХрк╣рлБркВ?</p>
<p>ркП рк╣рк╛рке ркЦркбркЦркбрк┐ркпрк╛ рк╣рлЛрк╡рк╛ ркЫркдрк╛ркВ</p>
<p>ркЬрлНркпрк╛рк░рлЗ ркорк╛рк░рк╛ ркЧрк╛рк▓ рккрк░ ркЖрк╡рлНркпрк╛,</p>
<p>ркЬрлНркпрк╛рк░рлЗ ркорк╛рк░рлА рккрлАрка рккрк╛ркЫрк│ ркарк░рлНркпрк╛,</p>
<p>ркдрлНркпрк╛рк░рлЗ ркП ркжрлБркирк┐ркпрк╛ркирлА рк╕рлМркерлА рк╕рк╛ркЪрлА ркирк░ркорк╛ркИ рк▓рк╛ркЧрлНркпрк╛ ЁЯлВтЬи.</p>
<p>ркХрлЗркЯрк▓рлАркХ ркирк░ркорк╛ркИ рк╕рлНрккрк░рлНрк╢ркорк╛ркВ ркиркерлА,</p>
<p>ркИркорк╛ркиркжрк╛рк░рлАркорк╛ркВ рк╣рлЛркп ркЫрлЗ.</p>
<p>ркоркирлЗ ркЖркЬрлЗ рккркг ркпрк╛ркж ркЫрлЗ</p>
<p>ркЬрлНркпрк╛рк░рлЗ ркорлЗркВ ркдрк╛рк░рк╛ ркЧрк╛рк▓ рккрк░ рк╣рк╛рке рклрлЗрк░рк╡рлНркпрк╛,</p>
<p>ркЕркирлЗ ркдрлБркВ ркерлЛркбрлА ркХрлНрк╖ркг ркорк╛ркЯрлЗ</p>
<p>ркмркзрлА ркЪрк┐ркВркдрк╛ ркнрлВрк▓рлА ркЧркИ ЁЯШК.</p>
<p>ркП рк╕рлНркорк┐ркд ркбрк░ркирлБркВ ркирк╣рлЛркдрлБркВ,</p>
<p>ркП ркУрк│ркЦрк╛ркгркирлБркВ рк╣ркдрлБркВ,</p>
<p>ркП ркЖрк░рк╛ркоркирлБркВ рк╣ркдрлБркВ ЁЯТЮ.</p>
<p>ркЕркирлЗ ркП ркорк╛ркерк╛ рккрк░ркирлБркВ ркЪрлБркВркмрки ЁЯТЛтАФ</p>
<p>ркдрк╛рк░рк╛ ркЪрк╣рлЗрк░рк╛ рккрк░ ркЧрк┐рк▓рлНркЯ рккркг рк╣ркдрлА,</p>
<p>ркЕркирлЗ ркЦрлБрк╢рлА рккркг.</p>
<p>ркЬрк╛ркгрлЗ ркжрк┐рк▓ рккрлЛркдрлЗ ркЬ рккрлЛркдрк╛ркирлЗ рк╕ркоркЬрк╛рк╡рлА рк░рк╣рлНркпрлБркВ рк╣рлЛркп.</p>
<p>ркЪрк┐ркВркдрк╛ ркирк╛ ркХрк░.</p>
<p>ркХркВркИ ркЦрлЛркЯрлБркВ ркирк╣рлЛркдрлБркВ.</p>
<p>ркХрлЗркЯрк▓рлАркХ ркХрлНрк╖ркгрлЛ рккрлНрк░рк╢рлНрки ркиркерлА ркорк╛ркЧркдрлА,</p>
<p>рклркХрлНркд рк╕рлНрк╡рлАркХрк╛рк░ ркорк╛ркВркЧрлЗ ркЫрлЗ ЁЯдН.</p>
<p>ркорк╛рк░рлБркВ рккрлНрк░рлЗрко ркХрлНркпрк╛рк░рлЗркп ркЙркдрк╛рк╡рк│ркорк╛ркВ ркирк╣рлЛркдрлБркВ ЁЯМ▒.</p>
<p>ркорлЗркВ ркдркирлЗ ркХрлНркпрк╛рк░рлЗркп ркирк┐рк░рлНркгркп ркорк╛ркЯрлЗ ркжркмрк╛рк╡рлА ркиркерлА,</p>
<p>ркХрлНркпрк╛рк░рлЗркп "рк╣ркоркгрк╛ркВ ркЬ" ркХрк╣рлА ркиркерлА.</p>
<p>ркоркирлЗ ркЦркмрк░ ркЫрлЗ</p>
<p>ркдрк╛рк░рк╛ ркнрлВркдркХрк╛рк│рлЗ ркдркирлЗ рк╕рк╛рк╡ркЪрлЗркд ркмркирк╛рк╡рлА ркЫрлЗ,</p>
<p>ркЬрлЛркбрк╛ркг ркдркирлЗ ркбрк░рк╛рк╡ркдрлБркВ рк▓рк╛ркЧркдрлБркВ ркеркпрлБркВ ркЫрлЗ ЁЯе║.</p>
<p>ркдрлБркВ ркЬрлЗ рк░рлАркдрлЗ ркЫрлЗ,</p>
<p>ркП рк░рлАркдрлЗ рк╕ркоркЬрк╡рк╛ркирлЛ рккрлНрк░ркпркдрлНрки</p>
<p>рк╣рлБркВ рк╣ркВркорлЗрк╢рк╛ ркХрк░ркдрлЛ рк░рк╣рлНркпрлЛ ркЫрлБркВ.</p>
<p>рк╣рлБркВ рк░рк╛рк╣ ркЬрлЛркИ рк░рк╣рлНркпрлЛ ркЫрлБркВ,</p>
<p>рккркг ркЕркЯркХрлА ркиркерлА ркЧркпрлЛ ЁЯХ░я╕П.</p>
<p>рк╣рлБркВ ркЖркЧрк│ рк╡ркзрлБркВ ркЫрлБркВ,</p>
<p>рк╡ркзрлБ рк╕ркоркЬркжрк╛рк░ ркмркирлАркирлЗ,</p>
<p>рк╡ркзрлБ рк╢рк╛ркВркд ркмркирлАркирлЗ ЁЯМ┐.</p>
<p>ркЬрлЗ ркжрк┐рк╡рк╕рлЗ ркдрлБркВ ркоркирлЗ рккрк╣рлЗрк▓рлАрк╡рк╛рк░ ркорк│рлА рк╣ркдрлА,</p>
<p>ркП ркЬ ркорк╛ркгрк╕ ркЖркЬрлЗ рккркг ркЕрк╣рлАркВ ркЫрлЗ.</p>
<p>ркЖркжрк░ ркмркжрк▓рк╛ркпрлЛ ркиркерлА.</p>
<p>ркзрлАрк░ркЬ ркЦрлВркЯрлА ркиркерлА.</p>
<p>ркнрк╛рк╡ркирк╛ ркбрк░рлА ркиркерлА.</p>
<p>ркЖ ркирк╡рлБркВ рк╡рк░рлНрк╖ рк╢рк░рлВ ркерк╛ркп ркЫрлЗ тЬи,</p>
<p>ркЕркирлЗ рк╣рлБркВ ркХрлЛркИ ркЬрк╡рк╛ркм ркиркерлА ркорк╛ркЧркдрлЛ.</p>
<p>ркорк╛рк░рлА ркПркХ ркЬ ркИркЪрлНркЫрк╛ ркЫрлЗтАФ</p>
<p>ркдрлБркВ ркдрк╛рк░рк╛ ркЕркнрлНркпрк╛рк╕ рккрк░ ркзрлНркпрк╛рки рк░рк╛ркЦркЬрлЗ ЁЯУЪ,</p>
<p>ркдрлБркВ ркЬрлЗ CA ркмркирк╡рк╛ ркорк╛ркЯрлЗ ркорк╣рлЗркиркд ркХрк░рлА рк░рк╣рлА ркЫрлЗ</p>
<p>ркП рк░рк╕рлНркдрлЗ рк╡рк┐рк╢рлНрк╡рк╛рк╕ рк░рк╛ркЦркЬрлЗ ЁЯМЯ.</p>
<p>ркзрлНркпрк╛рки ркнркЯркХрк╛рк╡рк╢рлЛ ркирк╣рлАркВ.</p>
<p>ркзрлАрк░ркЬ рк░рк╛ркЦркЬрлЗ ЁЯХКя╕П.</p>
<p>ркЕркирлЗ ркнркЧрк╡рк╛ркиркирлА ркпрлЛркЬркирк╛ рккрк░ рк╡рк┐рк╢рлНрк╡рк╛рк╕ рк░рк╛ркЦркЬрлЗ ЁЯЩП,</p>
<p>ркнрк▓рлЗ ркЕркдрлНркпрк╛рк░рлЗ ркмркзрлБркВ рк╕рлНрккрк╖рлНркЯ рки рк▓рк╛ркЧркдрлБркВ рк╣рлЛркп.</p>
<p>ркЕркирлЗ ркЬрлЛ ркХрлНркпрк╛рк░рлЗркХ рк░рк╛ркдрлЗ ркорки ркнрк╛рк░рлЗрк▓рлБркВ рк▓рк╛ркЧрлЗ ЁЯМЩ,</p>
<p>ркдрлЛ ркЖ ркпрк╛ркж рк░рк╛ркЦркЬрлЗтАФ</p>
<p>ркХрлЛркИ рк╢рлЛрк░ рк╡ркЧрк░,</p>
<p>ркХрлЛркИ ркЕрккрлЗркХрлНрк╖рк╛ рк╡ркЧрк░,</p>
<p>ркХрлЛркИ рк╢рк░ркд рк╡ркЧрк░,</p>
<p>рк╣рлБркВ рк╣ркЬрлБ рккркг ркЕрк╣рлАркВ ркЬ ркЫрлБркВ ЁЯдН.</p>
<p>ркП ркЬ рк░рлАркдрлЗ ркпрк╛ркж ркХрк░ркдрк╛,</p>
<p>ркП ркЬ рк░рлАркдрлЗ ркЪрк┐ркВркдрк╛ ркХрк░ркдрк╛,</p>
<p>ркЕркирлЗ ркдркирлЗ ркЬрлЗрк╡рлА ркЫрлЗ ркПрк╡рлА ркЬ рк╕рлНрк╡рлАркХрк╛рк░ркдрк╛ ЁЯлВ.</p>
<p>ркирк╡рлБркВ рк╡рк░рлНрк╖ 2026 ркорлБркмрк╛рк░ркХ ЁЯОЖтЬи</p>
<p>ркЖ рк╡рк░рлНрк╖ ркдрк╛рк░рк╛ ркорк╛ркЯрлЗ ркирк░рко рк░рк╣рлЗ ЁЯдН,</p>
<p>ркдркирлЗ ркХрлЗркирлНркжрлНрк░рк┐ркд рк░рк╛ркЦрлЗ ЁЯОп,</p>
<p>ркдркирлЗ ркзрлАрк░ркЬ рк╢рлАркЦрк╡рлЗ ЁЯМ╕,</p>
<p>ркЕркирлЗ ркнркЧрк╡рк╛ркиркирлА ркпрлЛркЬркирк╛ рккрк░ рк╡рк┐рк╢рлНрк╡рк╛рк╕ ркЕрккрк╛рк╡рлЗтАФ</p>
<p>ркЬрлНркпрк╛ркВ рк╕рлБркзрлА ркмркзрлБркВ рк╕ркоркЬрк╛ркИ рки ркЬрк╛ркп ркдрлНркпрк╛ркВ рк╕рлБркзрлА рккркг ЁЯЩП.</p>
<div class="marwadi-box">
    <p>рдореНрд╣рд╛рд░реЛ рдорди рддрдиреНрд╣рд╛ рд░рд╛рдд рдорд╛, рддреЗрд░реЛ рдпрд╛рдж рдЖрд╡реЗ,</p>
    <p>рдЪреБрдкрдЪрд╛рдк, рдмрд┐рдирд╛ рд╢рдмреНрдж рдХреЗ, рджрд┐рд▓ рдзрдбрд╝рдХрди рд╕реБрдирд╛рд╡реЗред</p>
</div>`;

// ============================================
// GLOBAL VARIABLES
// ============================================
let isInitialized = false;
let currentVideo = null;
let imageSequenceStarted = false;
let timer1Interval, timer2Interval;
let bgmAudio = null;
let isMusicPlaying = false;

// ============================================
// MOBILE OPTIMIZATION
// ============================================
function optimizeForMobile() {
    const heartsContainer = document.getElementById('heartsBg');
    const isMobile = window.innerWidth <= 768;
    
    heartsContainer.innerHTML = '';
    
    const heartCount = isMobile ? 6 : 10;
    
    for (let i = 0; i < heartCount; i++) {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.innerHTML = 'тЭдя╕П';
        
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.fontSize = (isMobile ? 14 : 20) + 'px';
        heart.style.animationDuration = (isMobile ? 15 : 25) + Math.random() * 15 + 's';
        heart.style.animationDelay = Math.random() * 5 + 's';
        
        heartsContainer.appendChild(heart);
    }
}

// ============================================
// INITIALIZATION
// ============================================
document.addEventListener('DOMContentLoaded', function() {
    if (!isInitialized) {
        // Load poetry content dynamically
        document.querySelector('#page2 .poetry-content').innerHTML = englishPoetry;
        document.querySelector('#page3 .poetry-content').innerHTML = gujaratiPoetry;
        
        // Create hearts optimized for current device
        optimizeForMobile();
        
        // Set up event listeners
        setupEventListeners();
        
        // Preload images in background
        preloadAssets();
        
        // Set up mobile optimization on resize
        window.addEventListener('resize', optimizeForMobile);
        
        isInitialized = true;
    }
});

// ============================================
// SETUP EVENT LISTENERS
// ============================================
function setupEventListeners() {
    // Music control
    const musicBtn = document.getElementById('musicBtn');
    const musicIcon = document.getElementById('musicIcon');
    const musicText = document.getElementById('musicText');
    const bgMusic = document.getElementById('bgMusic');
    
    musicBtn.addEventListener('click', function() {
        if (isMusicPlaying) {
            bgMusic.pause();
            musicIcon.textContent = 'ЁЯО╡';
            musicText.textContent = 'Play Music';
            isMusicPlaying = false;
        } else {
            bgMusic.play().catch(e => console.log('Play prevented:', e));
            musicIcon.textContent = 'тП╕я╕П';
            musicText.textContent = 'Pause Music';
            isMusicPlaying = true;
        }
    });

    // Auto-play music on first click
    document.addEventListener('click', function initMusic() {
        if (!isMusicPlaying) {
            bgMusic.play().then(() => {
                musicIcon.textContent = 'тП╕я╕П';
                musicText.textContent = 'Pause Music';
                isMusicPlaying = true;
            }).catch(e => console.log('Autoplay prevented:', e));
        }
        document.removeEventListener('click', initMusic);
    }, { once: true });

    // Click flower animation
    document.addEventListener('click', function(e) {
        createFlowerClick(e.clientX, e.clientY);
    });
}

// ============================================
// PRELOAD ASSETS
// ============================================
function preloadAssets() {
    // Images
    const images = ['image1.jpg', 'image2.jpg', 'image3.jpg'];
    images.forEach(img => {
        const image = new Image();
        image.src = img;
    });
    
    // BGM audio
    bgmAudio = new Audio('Bgm.mp3');
    bgmAudio.loop = false;
    bgmAudio.volume = 0.7;
    bgmAudio.preload = 'metadata';
}

// ============================================
// PAGE NAVIGATION
// ============================================
function showPage(pageId) {
    // Fade out current page
    const currentPage = document.querySelector('.page.active');
    if (currentPage) {
        currentPage.style.opacity = '0';
        currentPage.style.transition = 'opacity 0.3s ease';
    }
    
    setTimeout(() => {
        // Hide all pages
        document.querySelectorAll('.page').forEach(page => {
            page.classList.remove('active');
            page.style.opacity = '1';
        });
        
        // Show new page
        const newPage = document.getElementById(pageId);
        newPage.classList.add('active');
        
        // Handle media
        handleMediaPlayback(pageId);
    }, 300);
}

// ============================================
// MEDIA PLAYBACK HANDLER
// ============================================
function handleMediaPlayback(pageId) {
    // Pause current media
    if (currentVideo) {
        currentVideo.pause();
        currentVideo = null;
    }
    
    // Handle video autoplay
    if (pageId === 'page4') {
        setTimeout(() => {
            currentVideo = document.getElementById('video1');
            if (currentVideo) {
                currentVideo.play().catch(e => console.log('Video 1 autoplay prevented:', e));
            }
        }, 500);
    }
    if (pageId === 'page5') {
        setTimeout(() => {
            currentVideo = document.getElementById('video2');
            if (currentVideo) {
                currentVideo.play().catch(e => console.log('Video 2 autoplay prevented:', e));
            }
        }, 500);
    }
    
    // Handle image sequence pages - UPDATED TIMERS
    if (pageId === 'page6') {
        startTimer(9, 'timerBtn1', 'page7');  // CHANGED: 9 seconds
    }
    if (pageId === 'page7') {
        startTimer(7, 'timerBtn2', 'page8');  // CHANGED: 7 seconds
    }
    if (pageId === 'page8') {
        waitForMusicCompletion();
    }
}

// ============================================
// START IMAGE SEQUENCE
// ============================================
function startImageSequence() {
    imageSequenceStarted = true;
    
    // Pause all other media
    document.querySelectorAll('video, audio').forEach(media => {
        if (media.id !== 'bgmAudio') {
            media.pause();
        }
    });
    
    // Play BGM for images
    if (bgmAudio) {
        bgmAudio.currentTime = 0;
        bgmAudio.play().catch(e => console.log('BGM play prevented:', e));
    }
    
    // Go to first image page
    showPage('page6');
}

// ============================================
// TIMER FUNCTIONS - UPDATED FOR 9s AND 7s
// ============================================
function startTimer(seconds, buttonId, nextPageId) {
    let timeLeft = seconds;
    const button = document.getElementById(buttonId);
    
    if (seconds === 7) {  // Changed from 7.8 to 7
        button.textContent = `Wait... (${seconds})`;
    } else {
        button.textContent = `Wait... (${Math.floor(timeLeft)})`;
    }
    
    const interval = setInterval(() => {
        timeLeft -= 0.1;
        
        if (seconds === 7) {  // Changed from 7.8 to 7
            button.textContent = `Wait... (${timeLeft.toFixed(1)})`;
        } else {
            button.textContent = `Wait... (${Math.ceil(timeLeft)})`;
        }
        
        if (timeLeft <= 0) {
            clearInterval(interval);
            button.textContent = seconds === 7 ? 'Next' : 'Next';  // Changed from 7.8 to 7
            button.disabled = false;
            
            button.onclick = function() {
                showPage(nextPageId);
            };
        }
    }, 100);
    
    if (buttonId === 'timerBtn1') {
        timer1Interval = interval;
    } else if (buttonId === 'timerBtn2') {
        timer2Interval = interval;
    }
}

// ============================================
// WAIT FOR MUSIC COMPLETION
// ============================================
function waitForMusicCompletion() {
    const button = document.getElementById('timerBtn3');
    
    if (bgmAudio) {
        const checkInterval = setInterval(() => {
            if (bgmAudio.ended || bgmAudio.currentTime >= 36) {
                clearInterval(checkInterval);
                button.textContent = 'Soo...';
                button.disabled = false;
                
                button.onclick = function() {
                    if (bgmAudio) {
                        bgmAudio.pause();
                        bgmAudio.currentTime = 0;
                    }
                    showPage('page9');
                };
            }
        }, 100);
    } else {
        setTimeout(() => {
            button.textContent = 'Soo...';
            button.disabled = false;
            
            button.onclick = function() {
                showPage('page9');
            };
        }, 36000);
    }
}

// ============================================
// FLOWER CLICK ANIMATION
// ============================================
function createFlowerClick(x, y) {
    const flowers = ['ЁЯМ╕', 'ЁЯМ╖', 'ЁЯТо', 'ЁЯМ║', 'ЁЯП╡я╕П', 'ЁЯМ╝', 'тЭА', 'тЬ┐'];
    
    for (let i = 0; i < 2; i++) {
        const flower = document.createElement('div');
        flower.className = 'flower-click';
        flower.style.left = x + 'px';
        flower.style.top = y + 'px';
        flower.style.fontSize = (16 + Math.random() * 16) + 'px';
        flower.style.color = ['#ffb6c1', '#ff69b4', '#ff1493'][Math.floor(Math.random() * 3)];
        flower.textContent = flowers[Math.floor(Math.random() * flowers.length)];
        
        const xOffset = (Math.random() * 60 - 30);
        flower.style.animation = `flowerFloat 2.5s forwards`;
        flower.style.setProperty('--x', `${xOffset}px`);
        flower.style.setProperty('--rotate', `${Math.random() * 360}deg`);
        
        document.body.appendChild(flower);
        
        setTimeout(() => flower.remove(), 2500);
    }
}

// ============================================
// CLEANUP INTERVALS
// ============================================
window.addEventListener('beforeunload', function() {
    if (timer1Interval) clearInterval(timer1Interval);
    if (timer2Interval) clearInterval(timer2Interval);
});

// ============================================
// GLOBAL FUNCTIONS
// ============================================
window.showPage = showPage;
window.startImageSequence = startImageSequence;
window.optimizeForMobile = optimizeForMobile;
